<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>SecureHome | Security Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ===== NAVBAR ===== -->
<nav class="navbar">
  <div class="brand">
    ğŸ” SecureHome
  </div>
  <div id="mode" class="badge off">DISARMED</div>
</nav>

<!-- ===== MAIN APP ===== -->
<main class="app">

  <section class="status-card off" id="statusCard">
    <h2 id="statusText">System Offline</h2>
    <p id="lastEvent">No events</p>
  </section>

  <section class="controls">
    <button id="armBtn">ARM SYSTEM</button>
    <button id="disarmBtn" disabled>DISARM</button>
  </section>

  <section class="history">
    <h3>Event History</h3>
    <ul id="history"></ul>
  </section>

</main>

<!-- ===== FOOTER ===== -->
<footer class="footer">
  <p><strong>SecureHome</strong> â€“ Smart Security Platform</p>
  <p>ESP32 Â· MQTT (HiveMQ Cloud) Â· Node.js Â· WebSockets</p>
  <p>Â© 2026 | Developed for academic use</p>
</footer>

<script>
  const ws = new WebSocket("ws://localhost:8080");

  let armed = false;

  const mode = document.getElementById("mode");
  const statusCard = document.getElementById("statusCard");
  const statusText = document.getElementById("statusText");
  const lastEvent = document.getElementById("lastEvent");
  const history = document.getElementById("history");

  const armBtn = document.getElementById("armBtn");
  const disarmBtn = document.getElementById("disarmBtn");

  armBtn.onclick = () => {
    armed = true;
    mode.textContent = "ARMED";
    mode.className = "badge armed";
    statusText.textContent = "System Armed";
    statusCard.className = "status-card idle";
    armBtn.disabled = true;
    disarmBtn.disabled = false;
  };

  disarmBtn.onclick = () => {
    armed = false;
    mode.textContent = "DISARMED";
    mode.className = "badge off";
    statusText.textContent = "System Offline";
    statusCard.className = "status-card off";
    armBtn.disabled = false;
    disarmBtn.disabled = true;
  };

  ws.onmessage = (event) => {
    if (!armed) return;

    const msg = event.data;
    const time = new Date().toLocaleTimeString();

    const li = document.createElement("li");
    li.textContent = `[${time}] ${msg}`;
    history.prepend(li);

    lastEvent.textContent = `${msg} at ${time}`;

    if (msg === "DETECTED") {
      statusCard.className = "status-card alert";
      statusText.textContent = "ğŸš¨ Intrusion Detected";
    } else {
      statusCard.className = "status-card safe";
      statusText.textContent = "ğŸŸ¢ Area Secure";
    }
  };
</script>

</body>
</html>
